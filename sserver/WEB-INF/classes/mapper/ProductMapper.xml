<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="cn.mrworlds.mapper.ProductMapper" >
  <resultMap id="BaseResultMap" type="cn.mrworlds.pojo.Product" >
    <id column="product_id" property="productId" jdbcType="INTEGER" />
    <result column="name" property="name" jdbcType="CHAR" />
    <result column="description" property="description" jdbcType="VARCHAR" />
    <result column="icon" property="icon" jdbcType="CHAR" />
    <result column="video" property="video" jdbcType="CHAR" />
    <result column="price" property="price" jdbcType="DECIMAL" />
    <result column="purchase_quantity" property="purchaseQuantity" jdbcType="INTEGER" />
    <result column="providerId" property="providerid" jdbcType="INTEGER" />
    <result column="point_limit" property="pointLimit" jdbcType="INTEGER" />
    <result column="gift_point" property="giftPoint" jdbcType="INTEGER" />
    <result column="product_type" property="productType" jdbcType="INTEGER" />
    <result column="referenceId" property="referenceid" jdbcType="INTEGER" />
    <result column="average_mark" property="averageMark" jdbcType="CHAR" />
    <result column="product_cata" property="productCata" jdbcType="INTEGER" />
    <result column="product_tag" property="productTag" jdbcType="CHAR" />
    <result column="guidance" property="guidance" jdbcType="VARCHAR" />
    <result column="attribuation1" property="attribuation1" jdbcType="VARCHAR" />
    <result column="point" property="point" jdbcType="VARCHAR" />
    <result column="isfroen" property="isfroen" jdbcType="INTEGER" />
    <result column="num" property="num" jdbcType="DOUBLE" />
    <result column="unit" property="unit" jdbcType="VARCHAR" />
    <result column="rate" property="rate" jdbcType="DOUBLE" />
  </resultMap>
  <sql id="Example_Where_Clause" >
    <where >
      <foreach collection="oredCriteria" item="criteria" separator="or" >
        <if test="criteria.valid" >
          <trim prefix="(" suffix=")" prefixOverrides="and" >
            <foreach collection="criteria.criteria" item="criterion" >
              <choose >
                <when test="criterion.noValue" >
                  and ${criterion.condition}
                </when>
                <when test="criterion.singleValue" >
                  and ${criterion.condition} #{criterion.value}
                </when>
                <when test="criterion.betweenValue" >
                  and ${criterion.condition} #{criterion.value} and #{criterion.secondValue}
                </when>
                <when test="criterion.listValue" >
                  and ${criterion.condition}
                  <foreach collection="criterion.value" item="listItem" open="(" close=")" separator="," >
                    #{listItem}
                  </foreach>
                </when>
              </choose>
            </foreach>
          </trim>
        </if>
      </foreach>
    </where>
  </sql>
  <sql id="Update_By_Example_Where_Clause" >
    <where >
      <foreach collection="example.oredCriteria" item="criteria" separator="or" >
        <if test="criteria.valid" >
          <trim prefix="(" suffix=")" prefixOverrides="and" >
            <foreach collection="criteria.criteria" item="criterion" >
              <choose >
                <when test="criterion.noValue" >
                  and ${criterion.condition}
                </when>
                <when test="criterion.singleValue" >
                  and ${criterion.condition} #{criterion.value}
                </when>
                <when test="criterion.betweenValue" >
                  and ${criterion.condition} #{criterion.value} and #{criterion.secondValue}
                </when>
                <when test="criterion.listValue" >
                  and ${criterion.condition}
                  <foreach collection="criterion.value" item="listItem" open="(" close=")" separator="," >
                    #{listItem}
                  </foreach>
                </when>
              </choose>
            </foreach>
          </trim>
        </if>
      </foreach>
    </where>
  </sql>
  <sql id="Base_Column_List" >
    product_id, name, description, icon, video, price, purchase_quantity, providerId,
    point_limit, gift_point, product_type, referenceId, average_mark, product_cata, product_tag,
    guidance, attribuation1, point, isfroen, num, unit, rate
  </sql>
  <select id="selectByExample" resultMap="BaseResultMap" parameterType="cn.mrworlds.pojo.ProductExample" >
    select
    <if test="distinct" >
      distinct
    </if>
    <include refid="Base_Column_List" />
    from product
    <if test="_parameter != null" >
      <include refid="Example_Where_Clause" />
    </if>
    <if test="orderByClause != null" >
      order by ${orderByClause}
    </if>
  </select>
  <select id="selectByPrimaryKey" resultMap="BaseResultMap" parameterType="java.lang.Integer" >
    select
    <include refid="Base_Column_List" />
    from product
    where product_id = #{productId,jdbcType=INTEGER}
  </select>
  <delete id="deleteByPrimaryKey" parameterType="java.lang.Integer" >
    delete from product
    where product_id = #{productId,jdbcType=INTEGER}
  </delete>
  <delete id="deleteByExample" parameterType="cn.mrworlds.pojo.ProductExample" >
    delete from product
    <if test="_parameter != null" >
      <include refid="Example_Where_Clause" />
    </if>
  </delete>
  <insert id="insert" parameterType="cn.mrworlds.pojo.Product" >
    insert into product (product_id, name, description,
      icon, video, price, purchase_quantity,
      providerId, point_limit, gift_point,
      product_type, referenceId, average_mark,
      product_cata, product_tag, guidance,
      attribuation1, point, isfroen,
      num, unit, rate)
    values (#{productId,jdbcType=INTEGER}, #{name,jdbcType=CHAR}, #{description,jdbcType=VARCHAR},
      #{icon,jdbcType=CHAR}, #{video,jdbcType=CHAR}, #{price,jdbcType=DECIMAL}, #{purchaseQuantity,jdbcType=INTEGER},
      #{providerid,jdbcType=INTEGER}, #{pointLimit,jdbcType=INTEGER}, #{giftPoint,jdbcType=INTEGER},
      #{productType,jdbcType=INTEGER}, #{referenceid,jdbcType=INTEGER}, #{averageMark,jdbcType=CHAR},
      #{productCata,jdbcType=INTEGER}, #{productTag,jdbcType=CHAR}, #{guidance,jdbcType=VARCHAR},
      #{attribuation1,jdbcType=VARCHAR}, #{point,jdbcType=VARCHAR}, #{isfroen,jdbcType=INTEGER},
      #{num,jdbcType=DOUBLE}, #{unit,jdbcType=VARCHAR}, #{rate,jdbcType=DOUBLE})
  </insert>
  <insert id="insertSelective" parameterType="cn.mrworlds.pojo.Product" >
    insert into product
    <trim prefix="(" suffix=")" suffixOverrides="," >
      <if test="productId != null" >
        product_id,
      </if>
      <if test="name != null" >
        name,
      </if>
      <if test="description != null" >
        description,
      </if>
      <if test="icon != null" >
        icon,
      </if>
      <if test="video != null" >
        video,
      </if>
      <if test="price != null" >
        price,
      </if>
      <if test="purchaseQuantity != null" >
        purchase_quantity,
      </if>
      <if test="providerid != null" >
        providerId,
      </if>
      <if test="pointLimit != null" >
        point_limit,
      </if>
      <if test="giftPoint != null" >
        gift_point,
      </if>
      <if test="productType != null" >
        product_type,
      </if>
      <if test="referenceid != null" >
        referenceId,
      </if>
      <if test="averageMark != null" >
        average_mark,
      </if>
      <if test="productCata != null" >
        product_cata,
      </if>
      <if test="productTag != null" >
        product_tag,
      </if>
      <if test="guidance != null" >
        guidance,
      </if>
      <if test="attribuation1 != null" >
        attribuation1,
      </if>
      <if test="point != null" >
        point,
      </if>
      <if test="isfroen != null" >
        isfroen,
      </if>
      <if test="num != null" >
        num,
      </if>
      <if test="unit != null" >
        unit,
      </if>
      <if test="rate != null" >
        rate,
      </if>
    </trim>
    <trim prefix="values (" suffix=")" suffixOverrides="," >
      <if test="productId != null" >
        #{productId,jdbcType=INTEGER},
      </if>
      <if test="name != null" >
        #{name,jdbcType=CHAR},
      </if>
      <if test="description != null" >
        #{description,jdbcType=VARCHAR},
      </if>
      <if test="icon != null" >
        #{icon,jdbcType=CHAR},
      </if>
      <if test="video != null" >
        #{video,jdbcType=CHAR},
      </if>
      <if test="price != null" >
        #{price,jdbcType=DECIMAL},
      </if>
      <if test="purchaseQuantity != null" >
        #{purchaseQuantity,jdbcType=INTEGER},
      </if>
      <if test="providerid != null" >
        #{providerid,jdbcType=INTEGER},
      </if>
      <if test="pointLimit != null" >
        #{pointLimit,jdbcType=INTEGER},
      </if>
      <if test="giftPoint != null" >
        #{giftPoint,jdbcType=INTEGER},
      </if>
      <if test="productType != null" >
        #{productType,jdbcType=INTEGER},
      </if>
      <if test="referenceid != null" >
        #{referenceid,jdbcType=INTEGER},
      </if>
      <if test="averageMark != null" >
        #{averageMark,jdbcType=CHAR},
      </if>
      <if test="productCata != null" >
        #{productCata,jdbcType=INTEGER},
      </if>
      <if test="productTag != null" >
        #{productTag,jdbcType=CHAR},
      </if>
      <if test="guidance != null" >
        #{guidance,jdbcType=VARCHAR},
      </if>
      <if test="attribuation1 != null" >
        #{attribuation1,jdbcType=VARCHAR},
      </if>
      <if test="point != null" >
        #{point,jdbcType=VARCHAR},
      </if>
      <if test="isfroen != null" >
        #{isfroen,jdbcType=INTEGER},
      </if>
      <if test="num != null" >
        #{num,jdbcType=DOUBLE},
      </if>
      <if test="unit != null" >
        #{unit,jdbcType=VARCHAR},
      </if>
      <if test="rate != null" >
        #{rate,jdbcType=DOUBLE},
      </if>
    </trim>
  </insert>
  <select id="countByExample" parameterType="cn.mrworlds.pojo.ProductExample" resultType="java.lang.Integer" >
    select count(*) from product
    <if test="_parameter != null" >
      <include refid="Example_Where_Clause" />
    </if>
  </select>
  <update id="updateByExampleSelective" parameterType="map" >
    update product
    <set >
      <if test="record.productId != null" >
        product_id = #{record.productId,jdbcType=INTEGER},
      </if>
      <if test="record.name != null" >
        name = #{record.name,jdbcType=CHAR},
      </if>
      <if test="record.description != null" >
        description = #{record.description,jdbcType=VARCHAR},
      </if>
      <if test="record.icon != null" >
        icon = #{record.icon,jdbcType=CHAR},
      </if>
      <if test="record.video != null" >
        video = #{record.video,jdbcType=CHAR},
      </if>
      <if test="record.price != null" >
        price = #{record.price,jdbcType=DECIMAL},
      </if>
      <if test="record.purchaseQuantity != null" >
        purchase_quantity = #{record.purchaseQuantity,jdbcType=INTEGER},
      </if>
      <if test="record.providerid != null" >
        providerId = #{record.providerid,jdbcType=INTEGER},
      </if>
      <if test="record.pointLimit != null" >
        point_limit = #{record.pointLimit,jdbcType=INTEGER},
      </if>
      <if test="record.giftPoint != null" >
        gift_point = #{record.giftPoint,jdbcType=INTEGER},
      </if>
      <if test="record.productType != null" >
        product_type = #{record.productType,jdbcType=INTEGER},
      </if>
      <if test="record.referenceid != null" >
        referenceId = #{record.referenceid,jdbcType=INTEGER},
      </if>
      <if test="record.averageMark != null" >
        average_mark = #{record.averageMark,jdbcType=CHAR},
      </if>
      <if test="record.productCata != null" >
        product_cata = #{record.productCata,jdbcType=INTEGER},
      </if>
      <if test="record.productTag != null" >
        product_tag = #{record.productTag,jdbcType=CHAR},
      </if>
      <if test="record.guidance != null" >
        guidance = #{record.guidance,jdbcType=VARCHAR},
      </if>
      <if test="record.attribuation1 != null" >
        attribuation1 = #{record.attribuation1,jdbcType=VARCHAR},
      </if>
      <if test="record.point != null" >
        point = #{record.point,jdbcType=VARCHAR},
      </if>
      <if test="record.isfroen != null" >
        isfroen = #{record.isfroen,jdbcType=INTEGER},
      </if>
      <if test="record.num != null" >
        num = #{record.num,jdbcType=DOUBLE},
      </if>
      <if test="record.unit != null" >
        unit = #{record.unit,jdbcType=VARCHAR},
      </if>
      <if test="record.rate != null" >
        rate = #{record.rate,jdbcType=DOUBLE},
      </if>
    </set>
    <if test="_parameter != null" >
      <include refid="Update_By_Example_Where_Clause" />
    </if>
  </update>
  <update id="updateByExample" parameterType="map" >
    update product
    set product_id = #{record.productId,jdbcType=INTEGER},
    name = #{record.name,jdbcType=CHAR},
    description = #{record.description,jdbcType=VARCHAR},
    icon = #{record.icon,jdbcType=CHAR},
    video = #{record.video,jdbcType=CHAR},
    price = #{record.price,jdbcType=DECIMAL},
    purchase_quantity = #{record.purchaseQuantity,jdbcType=INTEGER},
    providerId = #{record.providerid,jdbcType=INTEGER},
    point_limit = #{record.pointLimit,jdbcType=INTEGER},
    gift_point = #{record.giftPoint,jdbcType=INTEGER},
    product_type = #{record.productType,jdbcType=INTEGER},
    referenceId = #{record.referenceid,jdbcType=INTEGER},
    average_mark = #{record.averageMark,jdbcType=CHAR},
    product_cata = #{record.productCata,jdbcType=INTEGER},
    product_tag = #{record.productTag,jdbcType=CHAR},
    guidance = #{record.guidance,jdbcType=VARCHAR},
    attribuation1 = #{record.attribuation1,jdbcType=VARCHAR},
    point = #{record.point,jdbcType=VARCHAR},
    isfroen = #{record.isfroen,jdbcType=INTEGER},
    num = #{record.num,jdbcType=DOUBLE},
    unit = #{record.unit,jdbcType=VARCHAR},
    rate = #{record.rate,jdbcType=DOUBLE}
    <if test="_parameter != null" >
      <include refid="Update_By_Example_Where_Clause" />
    </if>
  </update>
  <update id="updateByPrimaryKeySelective" parameterType="cn.mrworlds.pojo.Product" >
    update product
    <set >
      <if test="name != null" >
        name = #{name,jdbcType=CHAR},
      </if>
      <if test="description != null" >
        description = #{description,jdbcType=VARCHAR},
      </if>
      <if test="icon != null" >
        icon = #{icon,jdbcType=CHAR},
      </if>
      <if test="video != null" >
        video = #{video,jdbcType=CHAR},
      </if>
      <if test="price != null" >
        price = #{price,jdbcType=DECIMAL},
      </if>
      <if test="purchaseQuantity != null" >
        purchase_quantity = #{purchaseQuantity,jdbcType=INTEGER},
      </if>
      <if test="providerid != null" >
        providerId = #{providerid,jdbcType=INTEGER},
      </if>
      <if test="pointLimit != null" >
        point_limit = #{pointLimit,jdbcType=INTEGER},
      </if>
      <if test="giftPoint != null" >
        gift_point = #{giftPoint,jdbcType=INTEGER},
      </if>
      <if test="productType != null" >
        product_type = #{productType,jdbcType=INTEGER},
      </if>
      <if test="referenceid != null" >
        referenceId = #{referenceid,jdbcType=INTEGER},
      </if>
      <if test="averageMark != null" >
        average_mark = #{averageMark,jdbcType=CHAR},
      </if>
      <if test="productCata != null" >
        product_cata = #{productCata,jdbcType=INTEGER},
      </if>
      <if test="productTag != null" >
        product_tag = #{productTag,jdbcType=CHAR},
      </if>
      <if test="guidance != null" >
        guidance = #{guidance,jdbcType=VARCHAR},
      </if>
      <if test="attribuation1 != null" >
        attribuation1 = #{attribuation1,jdbcType=VARCHAR},
      </if>
      <if test="point != null" >
        point = #{point,jdbcType=VARCHAR},
      </if>
      <if test="isfroen != null" >
        isfroen = #{isfroen,jdbcType=INTEGER},
      </if>
      <if test="num != null" >
        num = #{num,jdbcType=DOUBLE},
      </if>
      <if test="unit != null" >
        unit = #{unit,jdbcType=VARCHAR},
      </if>
      <if test="rate != null" >
        rate = #{rate,jdbcType=DOUBLE},
      </if>
    </set>
    where product_id = #{productId,jdbcType=INTEGER}
  </update>
  <update id="updateByPrimaryKey" parameterType="cn.mrworlds.pojo.Product" >
    update product
    set name = #{name,jdbcType=CHAR},
      description = #{description,jdbcType=VARCHAR},
      icon = #{icon,jdbcType=CHAR},
      video = #{video,jdbcType=CHAR},
      price = #{price,jdbcType=DECIMAL},
      purchase_quantity = #{purchaseQuantity,jdbcType=INTEGER},
      providerId = #{providerid,jdbcType=INTEGER},
      point_limit = #{pointLimit,jdbcType=INTEGER},
      gift_point = #{giftPoint,jdbcType=INTEGER},
      product_type = #{productType,jdbcType=INTEGER},
      referenceId = #{referenceid,jdbcType=INTEGER},
      average_mark = #{averageMark,jdbcType=CHAR},
      product_cata = #{productCata,jdbcType=INTEGER},
      product_tag = #{productTag,jdbcType=CHAR},
      guidance = #{guidance,jdbcType=VARCHAR},
      attribuation1 = #{attribuation1,jdbcType=VARCHAR},
      point = #{point,jdbcType=VARCHAR},
      isfroen = #{isfroen,jdbcType=INTEGER},
      num = #{num,jdbcType=DOUBLE},
      unit = #{unit,jdbcType=VARCHAR},
      rate = #{rate,jdbcType=DOUBLE}
    where product_id = #{productId,jdbcType=INTEGER}
  </update>
  <update id="updatePriceByID" >
    update product
    set price = #{price,jdbcType=INTEGER},point = #{point,jdbcType=VARCHAR}
    where product_id = #{productId,jdbcType=INTEGER}
  </update>
  <select id="getMaxID" resultType="java.lang.Integer" >
      select max(product_id) from product
  </select>

  <select id="undealItems" resultType="cn.mrworlds.pojo.Orderitem">
        select orderitem.*from orderitem
        left JOIN cmsorder
        on `orderitem`.id = cmsorder.orderItem  and  orderitem.itemType = 'RENTAGE'
        where unix_timestamp(orderitem.time) > unix_timestamp(DATE_SUB(now(),interval 5 HOUR))
        and (cmsorder.status is NULL or cmsorder.status !=1024 )
        and orderitem.productID = #{productID,jdbcType=INTEGER}
  </select>

<!--  void deleteOneProduct(@Param ("productID")Integer productID);-->
  <update id="deleteOneProduct">
    update product
    set delflag = 0
    where product_id = #{productID,jdbcType=INTEGER}
  </update>
</mapper>